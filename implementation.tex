{\bf{\SetMySection} Реализация среды моделирования передачи сообщений в сети автомобилей.} Основным методом исследования является имитационное моделирование работы сети в среде ns-3 (дискретно-событийный симулятор телекоммуникационных систем\cite{Nsnam.org}).
 
Симулятор ns-3 является свободным программным обеспечением, распространяемым по лицензии GPL, он ориентирован на исследовательское применение, а так же применение в образовательных целях. Исходные коды ns--3 открыты для исследования, модификации и использования и доступны на сайте проекта\cite{Nsnam.org}. В качестве встроенного языка описания моделей используются: C++ и Python.

В ns-3 разработаны модели как проводных, так и беспроводных сетей, позволяющие проводить моделирование смешанных сетей с топологиями различной сложности. Особый интерес в рамках данной работы представляет реализация mesh сетей на основе стека протоколов 802.11s.

Для построения транспортной сети и моделирования движения транспорта применена модель движения транспорта Intelligent Driver Model (IDM)\cite{5678993}.

Модель IDM описывает движение транспортного средства (ТС) по сети дорог, учитывая расположение ТС на полосах движения, габаритные размеры ТС, дистанцию между ТС, поведение ТС при смене полосы движения, направление движения полос, среднюю скорость движения и ускорение в заданной полосе, сигналы светофоров, распределение транспортных потоков на перекрёстках\cite{5678993}.

{\bf{\SetMySubSection} Среда постановки эксперимента для мультипротокольной сети транспортных средств\cite{Instrumental}.} Для эффективного управления данными к среде моделирования были выдвинуты следующие требования:

\begin{itemize}

\item[$-$] изменение параметров: число абонентов, топология сети, закон изменения движения, протокол передачи данных, размер и интенсивность появления пакетов;

\item[$-$] сбор статистики после проведённой симуляции;

\item[$-$] автоматический запуск набора экспериментов с различными параметрами;

\item[$-$] конфигурация эксперимента как входной набор параметров в виде файла.

\end{itemize}

\begin{figure}[!ht]
% \vspace{-0.2cm}
 \centering{
 \epsfig{file = architecture.eps, width = 6cm}
 \caption{Архитектура среды моделирования.}
 \label{fig:architecture}}
% \vspace{-0.1cm}
\end{figure}

На рисунке ~\ref{fig:architecture} приведена разработанная структура среды модели мультипротокольной сети.

Реализованная модель содержит следующие модули ns-3: 

\begin{itemize}

\item[$-$]Модель интерфейса 802.11s\cite{Andreev}. Реализация допускает применение протокола маршрутизации HWMP в режиме с использованием корневого узла и с построением маршрута передачи по запросу, кроме этого будут использованы протоколы маршрутизации для беспроводных mesh сетей: OLSR, AODV, DSDV.
-Реализации моделей протоколов маршрутизации в беспроводных сетях HWMP, OLSR, AODV, DSDV\cite{Narra:2011:DDV:2151054.2151132}.

\item[$-$]FlowMonitor - модуль сбора и обработки статистики сетевого трафика, предоставляющий разнообразные методы сбора характеристик моделируемых сетевых устройств и каналов связи. 

\item[$-$]WireShark анализатор трафика компьютерных сетей, предоставляющий широкие возможности по фильтрации и сортировке данных трафика различных сетевых протоколов.
 
\item[$-$]PyViz модуль визуализации моделей, позволяющий отображать топологию моделируемой сети, потоки данных, характеристики интерфейсов и каналов, а также их изменения на протяжении симуляции.

\end{itemize}

Реализованная схема взаимодействия модулей позволяет комбинировать различные протоколы маршрутизации, сетевые интерфейсы, модели движения узлов сети. Параметры моделирования передаются в класс NetworkNodes, где происходит выбор и настройка протоколов маршрутизации, создание нескольких сетевых интерфейсов, установка скорости передачи данных, числа передающих узлов и типа сетевого трафика. Результатом моделирования является набор xml-файлов сгенерированных модулем FlowMonitor.
 
Для реализации комбинации беспроводных сетей разработана модель подвижного мультипротокольного узла с набором сетевых интерфейсов. Для реализации мультипротокольного узла добавлен новый класс, позволяющий комбинировать интерфейсы стандартов: 802.11abg, 802.11s, 802.11p, LTE. 

{\bf{\SetMySubSection} Описание мультипротокольного узла в среде моделирования.} Алгоритм создания мультипротокольного узла, обеспечивающего взаимодействие двух сетей, на примере, LTE и mesh (802.11s):

\begin{enumerate}

\item[$-$] создать узлы с интерфейсом 802.11s. (класс NodeContainer);

\item[$-$] задать модель движения узлов LTE (важно это сделать до установки самих UE и eNB интерфейсов);

\item[$-$] создать узлы базовых станций LTE (eNB, метод InstallEnbDevice, класса LteHelper); 

\item[$-$] создать узлы клиентов LTE (UE, метод InstallUeDevice, класса LteHelper);

\item[$-$] создать виртуальный узел "точка-точка", выполняющий роль промежуточного звена для соединения интерфейса LTE и mesh;

\item[$-$] установить интерфейс LTE в mesh узел (метод Add класса NodeContainer);

\item[$-$] создать шлюз для соединения LTE с внешней сетью (метод GetPgwNode класса EpcHelper);

\item[$-$] назначить IP-адреса узлам сети, включая виртуальный узел (метод Assign класса Ipv4InterfaceContainer);

\item[$-$] задать маршрут от выбранного узла к LTE сети, через промежуточный мультипротокольный узел с mesh и LTE (метод AddNetworkRouteTo класса Ipv4StaticRouting);

\item[$-$] установить маршрут по умолчанию на LTE интерфейсах (через шлюз в этой сети, адрес шлюза получается методом GetUeDefaultGatewayAddress класса EpcHelper и устанавливается методом SetDefaultRoute класса Ipv4StaticRouting). 

\end{enumerate}

Для проведения эксперимента была создана модель узла позволяющая осуществлять доставку пакетов между мультипротокольными узлами mesh-сети для сетей 802.11s и LTE.
Такая схема взаимодействия потребовала, дополнительно создания виртуального интерфейса, через который бы происходила маршрутизация между сетями.
%Базовая реализация взаимодействия показана на рисунке~\ref{fig:basic_realisation}.

Модель узла реализующая функцию маршрутизации сообщений между сетями передачи данных 802.11s и LTE показана на рисунке~\ref{fig:multiprotocol_realisation}.
Реализация мультипротокольного узла выполнена на основе виртуального узла точка-точка, обеспечивающего промежуточное взаимодействие между интерфейсами 802.11s и LTE.

%\begin{figure}[!ht]
% \vspace{-0.2cm}
% \centering{
% \epsfig{file = basic_realisation, width = 6cm}
% \caption{Базовая реализация шлюза 802.11s-802.11p.}
% \label{fig:basic_realisation}}
% \vspace{-0.1cm}
%\end{figure}
 
\begin{figure}[!ht]
% \vspace{-0.2cm}
 \centering{
 \epsfig{file = miltiprotocol_realisation.eps, width = 8cm}
 \caption{Реализация мультипротокольного узла.}
 \label{fig:multiprotocol_realisation}}
% \vspace{-0.1cm}
\end{figure}

В процессе моделирования перемещение мультипротокольного подвижного узла осуществляется путем задания параметров схемы движения транспортного средства. Координаты мультипротокольного мобильного узла наследуются от координат транспортного средства. Перемещение узла осуществляется дискретно с интервалом 0.1 секунда, в течение всего периода моделирования.

%FIXME переделать в список?
{\bf{\SetMySubSection} Параметры эксперимента.} Для проведения исследований разработана технология инициализации параметров: распределение событий связанных с перемещением абонента (изменение скорости и характера движения); процент потерь пакетов в канале; применяемые протоколы маршрутизации; скорость передачи данных; число узлов в моделируемой сети; количество узлов ведущих одновременную передачу; размер передаваемых пакетов; тип транспортного протокола передачи данных. В процессе моделирования измеряемыми параметрами являются: время отправки пакета, время получения пакета, число потерянных пакетов, число отправленных пакетов, размер пакетов, IP адреса источников и получателей сообщений.
